## 06.03.2024 — CVE-2024-21626 Взлом runc process.cwd и утечка контейнера fds {#CVE-2024-21626}

Идентификатор CVE (CVE ID): CVE-2024-21626

Ссылка на CVE: <https://nvd.nist.gov/vuln/detail/CVE-2023-23919>

### Исходный отчет {#original-report}

<https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv>

### Краткое описание {#brief-description}

runc – это инструмент CLI для создания и запуска контейнеров на Linux согласно спецификации OCI. В runc 1.1.11 и более ранних версиях, вследствие утечки внутреннего дескриптора файлов, злоумышленник мог запустить процесс создания контейнера из `runc exec` с целью получения рабочей директории в пространстве имен файловой системы хоста. Таким образом, могла произойти утечка контейнера через предоставление доступа к файловой системе хоста («атака 2»). Подобная атака могла быть организована и с помощью вредоносного образа, благодаря которому процесс контейнера получал доступ к файловой системе хоста через `runc run` («атака 1»). Разновидности атак 1 и 2 также могли использоваться для перезаписи полупроизвольных бинарных файлов хоста, что приводило к полной утечке контейнера («атака 3а» и «атака 3б»).

Патч, включенный в runc версии 1.1.12, устраняет данную проблему.

### Затронутые технологии {#technologies-affected}

runc

### Уязвимые продукты и версии {#vulnerable-products-and-versions}

От версии 1.0.0 до 1.1.11 включительно.

### Вектор атаки и уровень опасности согласно CVSS v.3.0 {#severity-level}

7,5 HIGH.

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

### Рекомендации по обнаружению уязвимости и дополнительные материалы {#recommendations}

Общедоступные фрагменты вредоносного кода:

* <https://github.com/Wall1e/CVE-2024-21626-POC>
* <https://github.com/NitroCao/CVE-2024-21626>

### Безопасная версия уязвимого продукта или патч {#safe-version}

Уязвимость устранена в версии 1.1.12.

### Влияние на сервисы {{ yandex-cloud }} {#impact-on-yandex-cloud-services}

Текущие и планируемые к выпуску образы, использующие `runc`, обновлены до последней версии. При использовании на ВМ собственного образа, который подвержен уязвимости, рекомендуется обновить его самостоятельно.
