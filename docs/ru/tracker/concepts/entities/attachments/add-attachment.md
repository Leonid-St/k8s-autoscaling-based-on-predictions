---
sourcePath: ru/tracker/api-ref/concepts/entities/attachments/add-attachment.md
---
# Прикрепить файл к сущности

Запрос позволяет прикрепить файл к [сущности](../about-entities.md). Прикрепленный файл отобразится на вкладке **О проекте** или **О портфеле**.

## Формат запроса {#query}

Перед выполнением запроса [получите доступ к API](../../access.md).

Чтобы прикрепить файл, используйте HTTP-запрос с методом `POST`.

```json
POST /{{ ver }}/entities/<тип_сущности>/<идентификатор_сущности>/attachments/<идентификатор_файла>
Host: {{ host }}
Authorization: OAuth <OAuth-токен>
{{ org-id }}
```

{% include [headings](../../../../_includes/tracker/api/headings.md) %}

{% cut "Ресурс" %}

Параметр | Описание | Тип данных
-------- | -------- | ----------
\<тип_сущности> |Тип сущности:<ul><li>project — проект;</li><li>portfolio — портфель.</li></ul>| Строка
\<идентификатор_сущности> | Идентификатор сущности. Чтобы получить идентификатор, посмотрите [список сущностей](../search-entities.md). | Строка
\<идентификатор_проекта_или_портфеля> | Идентификатор проекта или портфеля (значение поля `shortId`). Его можно использовать в запросе вместо идентификатора сущности. | Строка
\<идентификатор_файла> | Идентификатор временного файла, который был [предварительно загружен](../../issues/temp-attachment.md) в {{ tracker-name }}. | Строка

{% note warning %}

Идентификатор сущности не совпадает с идентификатором проекта или портфеля.

{% endnote %}

{% endcut %}

{% cut "Параметры запроса" %}

**Дополнительные параметры**

Параметр | Описание | Тип данных
-------- | -------- | ----------
notify | Уведомлять пользователей, которые указаны в полях **Автор**, **Ответственный**, **Участники**, **Заказчики** и **Наблюдатели**. Значение по умолчанию — `true`. | Логический
notifyAuthor | Уведомлять автора изменений. Значение по умолчанию — `false`. | Логический
[fields](../about-entities.md#query-params) | Дополнительные поля сущности, которые будут включены в ответ. | Строка
expand | Дополнительная информация, которая будет включена в ответ: <ul><li>`all` — все;</li><li>`attachments` — вложенные файлы.</li></ul> | Строка

{% endcut %}

> Пример: Прикрепить файл к сущности
>
> - Используется HTTP-метод POST.
> - В ответе выводится информация о всех прикрепленных файлах.
>
> ```
> POST /v2/entities/project/<идентификатор_проекта>/attachments/30?expand=attachments
> Host: {{ host }}
> Authorization: OAuth <OAuth-токен>
> {{ org-id }}
> ```

## Формат ответа {#answer}

{% list tabs %}

- Запрос выполнен успешно

  {% include [answer-200](../../../../_includes/tracker/api/answer-200.md) %}

  Тело ответа содержит информацию о вложении сущности.

  ```json
  {
      "self": "{{ host }}/v2/entities/project/6586d6fee2b9ef74********", 
      "id": "6586d6fee2b9ef74********", 
      "version": 78, 
      "shortId": 4, 
      "entityType": "project", 
      "createdBy": {
          "self": "{{ host }}/v2/users/19********",
          "id": "19********",
          "display": "Имя Фамилия",
          "cloudUid": "ajeppa7dgp53********",
          "passportUid": "15********"
      },
      "createdAt": "2023-12-23T12:47:58.405+0000", 
      "updatedAt": "2024-01-13T14:06:29.747+0000",
      "attachments": [
          {
              "self": "{{ host }}/v2/attachments/4", 
              "id": "4", 
              "name": "newimage.jpg", 
              "content": "{{ host }}/v2/attachments/4/newimage.jpg", 
              "createdBy": {
                  "self": "{{ host }}/v2/users/19********",
                  "id": "19********",
                  "display": "Имя Фамилия",
                  "cloudUid": "ajeppa7dgp53********",
                  "passportUid": "15********"
              },
              "createdAt": "2024-01-11T06:24:57.635+0000", 
              "mimetype": "image/jpeg", 
              "size": 20466
          }
      ]
  }
  ```

  {% cut "Параметры ответа" %}

  Параметр | Описание | Тип данных
  -------- | -------- | ----------
  self | Адрес ресурса API, который содержит информацию о сущности. | Строка
  id | Идентификатор сущности. | Строка
  version | Версия сущности. Каждое изменение параметров увеличивает номер версии. | Число
  shortId | Идентификатор проекта или портфеля. | Строка
  entityType | Тип сущности. | Строка
  [createdBy](#created-by) | Блок с информацией о создателе сущности. | Объект
  createdAt | Дата создания сущности в формате `YYYY-MM-DDThh:mm:ss.sss±hhmm`. | Строка
  updatedAt | Дата последнего обновления сущности в формате `YYYY-MM-DDThh:mm:ss.sss±hhmm`. | Строка
  [attachments](#attachments) | Массив объектов с информацией о вложении. | Массив объектов
  
  **Поля объекта** `attachments` {#attachments}
  
  Параметр | Описание | Тип данных
  ----- | ----- | -----
  self | Адрес ресурса API, который содержит информацию о прикрепленных файлах сущности. | Строка
  id | Идентификатор файла. | Строка
  name | Имя файла. | Строка
  content | Адрес ресурса для скачивания файла. | Строка
  thumbnail | Адрес ресурса для скачивания миниатюры предпросмотра. Доступно только для графических файлов. | Строка
  [createdBy](#createdBy) | Объект с информацией о пользователе, прикрепившем файл. | Объект
  createdAt | Дата и время загрузки файла в формате `YYYY-MM-DDThh:mm:ss.sss±hhmm`. | Строка
  mimetype | Тип файла, например:<ul><li>`text/plain` — текстовый файл;</li><li>`image/png` — изображение в формате png.</li></ul> | Строка
  size | Размер файла в байтах. | Целое число
  [metadata](#metadata) | Объект с метаданными файла. | Объект

  **Поля объекта** `createdBy` {#created-by}

  Параметр | Описание | Тип данных
  ----- | ----- | -----
  self | Адрес ресурса API, который содержит информацию о пользователе. | Строка
  id | Идентификатор пользователя. | Число
  display | Отображаемое имя пользователя. | Строка
  cloudUid | Уникальный идентификатор пользователя в {{ org-full-name }}. | Строка
  passportUid | Уникальный идентификатор аккаунта пользователя в организации {{ ya-360 }} и Яндекс ID. | Строка

  **Поля объекта** `metadata` {#metadata}

  Параметр | Описание | Тип данных
  ----- | ----- | -----
  size | Размер изображения в пикселях. | Строка
  
  {% endcut %}

- Запрос выполнен с ошибкой

  Если запрос не был успешно обработан, API возвращает ответ с кодом ошибки:

  {% include [error-400](../../../../_includes/tracker/api/answer-error-400.md) %}
  
  {% include [error-404](../../../../_includes/tracker/api/answer-error-404.md) %}
  
  {% include [error-422](../../../../_includes/tracker/api/answer-error-422.md) %}

{% endlist %}
