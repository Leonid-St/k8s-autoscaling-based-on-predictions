## 05/07/2024: CVE-2024-6387 RegreSSHion {#CVE-2024-6387}

CVE ID: CVE-2024-6387

CVE link: <https://www.cve.org/CVERecord?id=CVE-2024-6387>

### Original report {#original-report}

<https://www.qualys.com/2024/07/01/cve-2024-6387/regresshion.txt>

### Summary {#brief-description}

The vulnerability lies in the race condition that appears on the OpenSSH server (sshd), which sometimes enables running remote code without authentication (RCE) under the `root` username in `glibc`-based Linux systems. This poses a significant threat to security. It takes at least six hours for the attacker to exploit this issue.

### Technologies affected

`openssh-server`

### Vulnerable products and versions {#vulnerable-products-and-versions}

* `openssh-server` before `4.4p1`
* `openssh-server` from `8.5p1` to `9.8p1`

### Vendor {#vendor}

OpenBSD Project

### Attack vector and severity level as per CVSS v.3.0 {#attack-vector-and-severity-level}

Base score: 8.1 HIGH

Vector: CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H

### Recommendations for vulnerability detection and supporting materials {#recommendations-for-vulnerability-detection}

As a workaround, set `LoginGraceTime` to `0` in `/etc/ssh/sshd_config`. This will prevent the exploit, although will potentially allow DDoS attacks on the server.

See also: <https://lists.mindrot.org/pipermail/openssh-unix-dev/2024-July/041431.html>

### Safe version of vulnerable product or patch {#safe-version}

Learn which `openssh-server` version you are currently using by running the `dpkg -l openssh-server` command. If your version is vulnerable, update your package to `9.8p1` or higher.

### How it impacts {{ yandex-cloud }} services {#impact-on-yandex-cloud-services}

We updated VM basic images to the latest version. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.

We checked for the presence of vulnerable internal {{ yandex-cloud }} services.