## 06/03/2024: CVE-2024-21626: runc process.cwd and leaked fds container breakout {#CVE-2024-21626}

CVE ID: CVE-2024-21626

CVE link: <https://nvd.nist.gov/vuln/detail/CVE-2023-23919>

### Original report {#original-report}

<https://github.com/opencontainers/runc/security/advisories/GHSA-xr7r-f8xq-vfvv>

### Summary {#brief-description}

runc is a CLI tool for spawning and running containers on Linux according to the OCI specification. In runc 1.1.11 and earlier, due to an internal file descriptor leak, an attacker could cause a newly-spawned container process (from `runc exec`) to have a working directory in the host filesystem namespace, allowing for a container escape by giving access to the host filesystem («attack 2»). The same attack could be used by a malicious image to allow a container process to gain access to the host filesystem through `runc run` «attack 1»). Variants of attacks 1 and 2 could be also be used to overwrite semi-arbitrary host binaries, allowing for complete container escapes («attack 3a» and «attack 3b»).

runc 1.1.12 includes patches for this issue.

### Technologies affected {#technologies-affected}

runc

### Vulnerable products and versions {#vulnerable-products-and-versions}

From v1.0.0 before v1.1.11

### Attack vector and severity level per CVSS v.3.0 {#severity-level}

7.5 High

CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H

### Recommendations for vulnerability detection and supporting materials {#recommendations}

Public exploits:

* <https://github.com/Wall1e/CVE-2024-21626-POC>
* <https://github.com/NitroCao/CVE-2024-21626>

### Safe version of vulnerable product or patch {#safe-version}

The vulnerability has been fixed as of version 1.1.12.

### Are cloud services affected? {#impact-on-yandex-cloud-services}

We updated current and upcoming images that use `runc` to the latest version. If you are using a custom image on your VMs and it is vulnerable, we recommend that you update it on your own.
